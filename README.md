# TUMmaze Project README

## 1\. 项目简介

TUMmaze 是一个基于 WebGL (Three.js) 的 3D 迷宫实验项目。该项目旨在收集用户在迷宫导航过程中的行为数据（如视口停留、轨迹、交互热图等），用于后续的空间认知与导航分析。

## 2\. 启动项目 (How to Start)

由于本项目是基于 Web 前端的，您可以通过以下任意一种方式启动：

  * **方式 A（推荐 - 本地服务器）：**
    在项目根目录下打开终端，运行 Python 内置服务器：

    ```bash
    # Python 3
    python -m http.server
    # 或者 Python 2
    python -m SimpleHTTPServer
    ```

    然后在浏览器访问 `http://localhost:8000` 即可。

  * **方式 B（直接打开）：**
    直接使用浏览器打开项目根目录下的 `index.html` 文件（注意：某些浏览器可能会因为跨域策略限制本地文件的资源加载，推荐使用方式 A）。

## 3\. 使用说明 (How to Use)

### 3.1 游戏控制

  * **移动**：使用键盘方向键 `↑` `↓` `←` `→` 或 `W` `A` `S` `D` 进行移动和转向。
  * **交互**：项目包含虚拟摇杆支持，适用于移动设备或触摸屏。

### 3.2 功能特性

  * **导航辅助**：包含透视墙体（青色）和终点导航线（红色）功能。
  * **数据采集**：
      * **视口数据**：每 250ms 自动记录一次相机位置、朝向以及与起点/终点的夹角。
      * **Minimap 热图**：记录用户在右上角小地图上的鼠标悬停（Hovers）和点击（Clicks）位置。
  * **数据导出**：
      * 实验结束后，点击右上角的 **"Export Data (JSON)"** 按钮，即可下载包含所有采集数据的 `.json` 日志文件。

## 4\. 数据分析1

项目提供了一个 Python 脚本用于处理导出的 JSON 日志文件。

### 功能：

  * **CSV 转换**：将 JSON 中的视口数据提取并转换为 CSV 格式。
  * **可视化绘图**：
      * **轨迹图 (Trajectory)**：绘制玩家在 X-Z 平面上的移动路径。
      * **角度变化图 (Angles)**：绘制玩家视角与起点/终点夹角随时间的变化曲线。

### 使用方法：

确保安装了依赖库（`matplotlib`, `numpy` 等），然后在终端运行：

```bash
python analyze_maze_logs.py <JSON文件路径或包含JSON的文件夹路径>
```

  * 输出结果将保存在 `maze_logs_summary.csv` 及 `plots/` 文件夹中。

### 分析代码 (`analyze_maze_logs.py`)

---

## 5\. 数据分析2 

本仓库包含一个用于处理迷宫实验用户数据的 Python 分析脚本（`1210process.py`），用于对眼动数据进行解析、凝视点（fixation）识别、兴趣区（AOI）分类以及可视化输出。该脚本可帮助评估参与者在任务过程中的视觉注意分布、导航策略及界面交互行为。

---

## **1. 输入数据结构**

脚本读取包含眼动追踪数据的 JSON 文件（`maze_user_data1210.json`），其中每条数据通常包含：

* `timestamp`：时间戳
* `x`：屏幕 X 坐标
* `y`：屏幕 Y 坐标

脚本自动提取 JSON 中的 `eyeTracking` 字段，并转换为 Pandas DataFrame 进行后续分析。

---

## **2. 凝视点（Fixation）检测：ID-T 算法**

脚本实现了简化版 **I-DT（基于离散度阈值的识别算法）**：

* **离散度阈值（Dispersion Threshold）**：50 像素
* **最小凝视时长**：100 ms
* 使用滑动窗口判断一段时间内眼动坐标的离散程度是否保持在阈值内
* 若满足条件则判定为一次凝视

每个检测出的凝视包含：

* 开始时间
* 结束时间
* 凝视持续时间
* 凝视的平均 X/Y 坐标

该步骤用于识别参与者在界面上“稳定注视”的区域。

---

## **3. AOI（兴趣区）分类**

脚本根据坐标将每个凝视点分类到不同界面区域，以支持界面使用行为分析：

* **小地图区域（左上）**：`x < 300` 且 `y < 200`
* **导出按钮区域（右上）**：`x > 1200` 且 `y < 150`
* **主视图区域**：其他所有位置

输出结果可显示：

* 各 AOI 的凝视次数
* 用户在任务过程里关注界面的哪些部分

该信息对理解用户导航策略和认知负荷尤为重要。

---

## **4. 可视化输出**

### **a. 热图（heatmap.png）**

* 使用 KDE 绘制的视线密度图
* 显示高频关注区域
* 包含原始眼动点的散点叠加
* Y 轴方向反转，以匹配屏幕坐标体系

### **b. 扫视路径图（scanpath.png）**

* 眼动点的时间顺序折线图（Scanpath）
* 标注 START 和 END
* 叠加 AOI 边界框以便观察注意力跳转
* 可用于研究用户搜索模式、策略效率与视觉负荷

---

## **5. 终端输出内容**

在运行脚本后终端会显示：

* 原始眼动数据点数
* 检测到的凝视数量
* 每个 AOI 的凝视次数统计



