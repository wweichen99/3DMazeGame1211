<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Maze 3D - Data Collection with Eye Tracking</title>
    <meta name="description" content="Maze 3D for WebGL with Three.js" />
    <meta name="author" content="Yannick Comte" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" media="screen" href="assets/css/style.css" />
    <style>
      /* Minimap (Labyrinth-style) */
      /* [MODIFIED] Top position adjusted to 50px to make room for the toggle button */
      #map { position: absolute; left: 10px; top: 50px; z-index: 10; }
      #minimap, #objects { position: absolute; left: 0; top: 0; }
      
      /* Data Export Button Style */
      #exportBtn {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 20;
        padding: 10px 20px;
        background-color: #28343A;
        color: #fff;
        border: 1px solid #00ffff;
        cursor: pointer;
        font-family: sans-serif;
        font-weight: bold;
      }
      #exportBtn:hover {
        background-color: #00ffff;
        color: #000;
      }

      /* [NEW] Minimap Toggle Button Style */
      #toggleMapBtn {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 20;
        padding: 8px 15px;
        background-color: #28343A;
        color: #fff;
        border: 1px solid #ffa500; /* Orange border to distinguish from export */
        cursor: pointer;
        font-family: sans-serif;
        font-weight: bold;
        font-size: 12px;
      }
      #toggleMapBtn:hover {
        background-color: #ffa500;
        color: #000;
      }

      /* WebGazer Video Feed Position Adjustment 
         Force the video container to bottom-left to avoid overlapping the Minimap (top-left) 
      */
      #webgazerVideoFeed, #webgazerVideoCanvas, #webgazerFaceOverlay, #webgazerFaceFeedbackBox {
        top: auto !important;
        bottom: 0px !important;
        left: 0px !important;
        right: auto !important;
      }
    </style>
    <script src="https://webgazer.cs.brown.edu/webgazer.js"></script>
  </head>
  <body>
    <img style="display:none" src="assets/images/preview-laby.png" alt="sharing image" />
    
    <button id="toggleMapBtn" onclick="toggleMinimap()">Hide Minimap</button>

    <button id="exportBtn" onclick="downloadMazeData()">Export Data (JSON)</button>

    <div id="canvasContainer" style="position:relative">
      <div id="map">
        <canvas id="minimap"></canvas>
        <canvas id="objects"></canvas>
      </div>
    </div>
    <audio id="bumpSound">
      <source src="assets/sound/bat.mp3" />
      <source src="assets/sound/bat.ogg" />
    </audio>
    <script src="assets/js/three.min.js"></script>
    <script src="assets/js/Demonixis.Input.js"></script>
    <script src="assets/js/Demonixis.Minimap.js"></script>
    <script src="assets/js/Demonixis.GameHelper.js"></script>
    <script src="assets/js/maze3d.js"></script>

    <script>
      function toggleMinimap() {
        var mapDiv = document.getElementById('map');
        var btn = document.getElementById('toggleMapBtn');
        
        // Check current display state
        if (mapDiv.style.display === 'none') {
          // Show it
          mapDiv.style.display = 'block';
          btn.innerText = 'Hide Minimap';
        } else {
          // Hide it
          mapDiv.style.display = 'none';
          btn.innerText = 'Show Minimap';
        }
      }
    </script>
  </body>
</html>